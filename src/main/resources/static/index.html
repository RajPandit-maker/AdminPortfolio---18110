<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monitoring Professional's Portfolio</title>
  <meta name="description" content="Admin-editable portfolio template ready to connect to a Spring Boot & Java backend." />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    body.admin-mode .editable-field {
      outline: 1px dashed rgba(45, 212, 191, 0.7);
      outline-offset: 3px;
      cursor: text;
      transition: background-color 0.15s ease, outline-color 0.15s ease;
    }
    body.admin-mode.no-highlight .editable-field {
      outline: none;
      background: transparent !important;
    }
    body.admin-mode .editable-field:focus {
      background: rgba(15, 23, 42, 0.9);
      outline-width: 2px;
    }
    .backdrop-blur-support {
      backdrop-filter: blur(18px);
    }
  </style>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen antialiased">
  <!-- Top Navigation / Admin Controls -->
  <header class="sticky top-0 z-40 border-b border-slate-800 bg-slate-950/80 backdrop-blur-support">
    <div class="max-w-5xl mx-auto flex items-center justify-between px-4 py-3">
      <div class="flex items-center gap-3">
        <div class="h-9 w-9 rounded-full bg-gradient-to-tr from-teal-500 to-cyan-400 flex items-center justify-center text-sm font-semibold tracking-tight">
          PRS
        </div>
        <div>
          <h1 id="nav-name" class="text-sm sm:text-base font-semibold tracking-tight">Pt Raj Sharma - Specialist</h1>
          <p id="nav-role" class="text-[11px] sm:text-xs text-slate-400">Monitoring & Automation Specialist | Java Backend Developer | Cybersecurity Learner</p>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <span id="admin-indicator" class="hidden text-[11px] px-3 py-1 rounded-full border border-emerald-500/60 bg-emerald-500/10 text-emerald-300 uppercase tracking-wide">
          Admin mode
        </span>
        <button id="login-btn" class="text-[11px] sm:text-xs px-3 py-1 rounded border border-slate-600 hover:border-cyan-400 hover:text-cyan-200 transition-colors">
          Admin login
        </button>
        <button id="logout-btn" class="hidden text-[11px] sm:text-xs px-3 py-1 rounded border border-slate-600 hover:border-rose-400 hover:text-rose-200 transition-colors">
          Logout
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-5xl mx-auto px-4 py-10 space-y-14">
    <!-- Hero -->
    <section class="grid gap-8 md:grid-cols-[minmax(0,3fr)_minmax(0,2fr)] items-center">
      <div class="space-y-6">
        <p class="text-xs uppercase tracking-[0.2em] text-teal-300/80">Portfolio</p>
        <div class="space-y-2">
          <h2
            data-key="hero-name"
            class="editable-field text-3xl sm:text-4xl md:text-5xl font-semibold tracking-tight leading-tight"
          >
            Pt Raj Sharma - Monitoring Professional
          </h2>
          <p
            data-key="hero-role"
            class="editable-field text-base sm:text-lg text-teal-300/90 font-medium"
          >
            Java &amp; Spring Boot Backend Engineer
          </p>
        </div>
        <p
          data-key="hero-summary"
          class="editable-field text-sm sm:text-base text-slate-300 max-w-xl leading-relaxed"
        >
          I design and build robust, testable backends using Java, Spring Boot, and modern cloud-native
          practices. I focus on clean architecture, readable code, and APIs that are easy to integrate and
          maintain.
        </p>
        <div class="flex flex-wrap gap-3">
          <a href="#projects" class="px-4 py-2 rounded-full bg-teal-500 text-slate-950 text-xs sm:text-sm font-medium hover:bg-teal-400 transition-colors">
            View projects
          </a>
          <a href="#contact" class="px-4 py-2 rounded-full border border-slate-600 text-xs sm:text-sm hover:border-cyan-400 hover:text-cyan-200 transition-colors">
            Contact
          </a>
        </div>
      </div>

      <div class="space-y-4">
        <div class="grid grid-cols-2 gap-3 text-xs sm:text-sm">
          <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-3">
            <p class="text-[11px] uppercase tracking-wide text-slate-400">Experience</p>
            <p
              data-key="hero-experience"
              class="editable-field mt-1 text-base sm:text-lg font-semibold"
            >
              4+ years
            </p>
          </div>
          <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-3">
            <p class="text-[11px] uppercase tracking-wide text-slate-400">Stack</p>
            <p
              data-key="hero-stack"
              class="editable-field mt-1 text-xs sm:text-sm text-slate-200"
            >
              Java · Spring Boot · REST · PostgreSQL · Docker · AWS
            </p>
          </div>
          <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-3 col-span-2">
            <p class="text-[11px] uppercase tracking-wide text-slate-400">Location / Remote</p>
            <p
              data-key="hero-location"
              class="editable-field mt-1 text-xs sm:text-sm text-slate-200"
            >
              Based in Berlin · Open to remote-friendly roles worldwide
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- About -->
    <section id="about" class="space-y-4">
      <div class="flex items-center justify-between gap-4">
        <h3 class="text-lg font-semibold tracking-tight">About</h3>
        <span class="text-[11px] uppercase tracking-[0.18em] text-slate-500">Profile</span>
      </div>
      <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 space-y-3">
        <p
          data-key="about-text"
          class="editable-field text-sm sm:text-base text-slate-300 leading-relaxed"
        >
          I am a backend-focused engineer who enjoys designing clean APIs, optimizing queries, and
          breaking complex problems into small, well-tested units. I am comfortable owning services end to
          end: from REST API design and data modeling to CI/CD and monitoring.
        </p>
        <p
          data-key="about-extra"
          class="editable-field text-sm sm:text-base text-slate-300 leading-relaxed"
        >
          My main tools are Java, Spring Boot, and relational databases, but I also work with messaging
          systems, Docker, and cloud platforms. I value clear communication, predictable delivery, and
          documentation that people actually read.
        </p>
      </div>
    </section>

    <!-- Experience -->
    <section id="experience" class="space-y-4">
      <div class="flex items-center justify-between gap-4">
        <h3 class="text-lg font-semibold tracking-tight">Experience</h3>
        <span class="text-[11px] uppercase tracking-[0.18em] text-slate-500">Work</span>
      </div>
      <div class="space-y-4">
        <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 flex flex-col gap-3 sm:flex-row sm:gap-6">
          <div class="w-full sm:w-40">
            <p
              data-key="exp1-period"
              class="editable-field text-xs font-medium text-slate-400"
            >
              2022 – Present
            </p>
            <p
              data-key="exp1-location"
              class="editable-field text-xs text-slate-500 mt-1"
            >
              Remote · Europe
            </p>
          </div>
          <div class="flex-1 space-y-2">
            <h4
              data-key="exp1-title"
              class="editable-field text-sm sm:text-base font-semibold"
            >
              Senior Backend Engineer · Fintech SaaS
            </h4>
            <p
              data-key="exp1-summary"
              class="editable-field text-xs sm:text-sm text-slate-300 leading-relaxed"
            >
              Led the design and implementation of payment and billing services built with Spring Boot,
              PostgreSQL, and Kafka. Focused on reliability, observability, and clear API contracts.
            </p>
            <ul
              data-key="exp1-bullets"
              class="editable-field list-disc list-outside pl-5 text-xs sm:text-sm text-slate-300 space-y-1"
            >
              <li>Designed REST APIs used by multiple client applications.</li>
              <li>Reduced response times for critical endpoints by 40% through query optimizations.</li>
              <li>Introduced contract testing and improved test coverage above 80%.</li>
            </ul>
          </div>
        </article>

        <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 flex flex-col gap-3 sm:flex-row sm:gap-6">
          <div class="w-full sm:w-40">
            <p
              data-key="exp2-period"
              class="editable-field text-xs font-medium text-slate-400"
            >
              2020 – 2022
            </p>
            <p
              data-key="exp2-location"
              class="editable-field text-xs text-slate-500 mt-1"
            >
              On-site · Berlin
            </p>
          </div>
          <div class="flex-1 space-y-2">
            <h4
              data-key="exp2-title"
              class="editable-field text-sm sm:text-base font-semibold"
            >
              Backend Engineer · Logistics Platform
            </h4>
            <p
              data-key="exp2-summary"
              class="editable-field text-xs sm:text-sm text-slate-300 leading-relaxed"
            >
              Built and maintained microservices responsible for order tracking, dispatch, and invoicing,
              using Java, Spring Boot, and MySQL.
            </p>
            <ul
              data-key="exp2-bullets"
              class="editable-field list-disc list-outside pl-5 text-xs sm:text-sm text-slate-300 space-y-1"
            >
              <li>Implemented event-driven workflows with RabbitMQ.</li>
              <li>Improved error handling and logging, reducing on-call incidents.</li>
              <li>Collaborated closely with frontend teams on API design and integration.</li>
            </ul>
          </div>
        </article>
      </div>
    </section>

    <!-- Projects -->
    <section id="projects" class="space-y-4">
      <div class="flex items-center justify-between gap-4">
        <h3 class="text-lg font-semibold tracking-tight">Projects</h3>
        <span class="text-[11px] uppercase tracking-[0.18em] text-slate-500">Selected</span>
      </div>
      <div class="grid gap-5 md:grid-cols-2">
        <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 flex flex-col justify-between gap-4">
          <div class="space-y-2">
            <h4
              data-key="proj1-title"
              class="editable-field text-sm sm:text-base font-semibold"
            >
              TaskFlow API – Task Management Platform
            </h4>
            <p
              data-key="proj1-description"
              class="editable-field text-xs sm:text-sm text-slate-300 leading-relaxed"
            >
              A RESTful task management backend built with Spring Boot, featuring role-based access,
              JWT authentication, and pagination-ready endpoints used by a React frontend.
            </p>
          </div>
          <div class="flex flex-wrap items-center justify-between gap-3 text-[11px] sm:text-xs">
            <p
              data-key="proj1-tech"
              class="editable-field text-slate-400"
            >
              Java · Spring Boot · Spring Security · PostgreSQL · Flyway · Docker
            </p>
            <p
              data-key="proj1-role"
              class="editable-field text-slate-400"
            >
              Role: Design, implementation, CI/CD
            </p>
          </div>
        </article>

        <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 flex flex-col justify-between gap-4">
          <div class="space-y-2">
            <h4
              data-key="proj2-title"
              class="editable-field text-sm sm:text-base font-semibold"
            >
              BillingHub – Subscription Billing Service
            </h4>
            <p
              data-key="proj2-description"
              class="editable-field text-xs sm:text-sm text-slate-300 leading-relaxed"
            >
              A microservice handling subscription plans, invoices, and payment events with idempotent
              processing and integration to external payment providers.
            </p>
          </div>
          <div class="flex flex-wrap items-center justify-between gap-3 text-[11px] sm:text-xs">
            <p
              data-key="proj2-tech"
              class="editable-field text-slate-400"
            >
              Java · Spring Boot · Spring Data JPA · Kafka · PostgreSQL
            </p>
            <p
              data-key="proj2-role"
              class="editable-field text-slate-400"
            >
              Role: Lead backend, system design
            </p>
          </div>
        </article>

        <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 flex flex-col justify-between gap-4 md:col-span-2">
          <div class="space-y-2">
            <h4
              data-key="proj3-title"
              class="editable-field text-sm sm:text-base font-semibold"
            >
              MetricsBoard – Service Monitoring Dashboard
            </h4>
            <p
              data-key="proj3-description"
              class="editable-field text-xs sm:text-sm text-slate-300 leading-relaxed"
            >
              Internal dashboard that aggregates metrics and logs from multiple services, exposes a
              unified API, and sends alerts based on configurable thresholds.
            </p>
          </div>
          <div class="flex flex-wrap items-center justify-between gap-3 text-[11px] sm:text-xs">
            <p
              data-key="proj3-tech"
              class="editable-field text-slate-400"
            >
              Java · Spring Boot · Prometheus · Grafana · Redis
            </p>
            <p
              data-key="proj3-role"
              class="editable-field text-slate-400"
            >
              Role: Backend, observability
            </p>
          </div>
        </article>
      </div>
    </section>

    <!-- Skills -->
    <section id="skills" class="space-y-4">
      <div class="flex items-center justify-between gap-4">
        <h3 class="text-lg font-semibold tracking-tight">Skills</h3>
        <span class="text-[11px] uppercase tracking-[0.18em] text-slate-500">Tech</span>
      </div>
      <div class="grid gap-4 md:grid-cols-3 text-xs sm:text-sm">
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4 space-y-2">
          <p class="text-[11px] uppercase tracking-wide text-slate-400">Languages</p>
          <p
            data-key="skills-languages"
            class="editable-field text-slate-200"
          >
            Java · SQL · Kotlin (basic) · JavaScript (basic)
          </p>
        </div>
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4 space-y-2">
          <p class="text-[11px] uppercase tracking-wide text-slate-400">Frameworks &amp; Tools</p>
          <p
            data-key="skills-frameworks"
            class="editable-field text-slate-200"
          >
            Spring Boot · Spring Data JPA · Spring Security · Hibernate · JUnit · Testcontainers
          </p>
        </div>
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4 space-y-2">
          <p class="text-[11px] uppercase tracking-wide text-slate-400">Infrastructure</p>
          <p
            data-key="skills-infra"
            class="editable-field text-slate-200"
          >
            PostgreSQL · MySQL · Docker · Kubernetes (basic) · AWS · CI/CD (GitHub Actions, GitLab CI)
          </p>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="space-y-4">
      <div class="flex items-center justify-between gap-4">
        <h3 class="text-lg font-semibold tracking-tight">Contact</h3>
        <span class="text-[11px] uppercase tracking-[0.18em] text-slate-500">Get in touch</span>
      </div>
      <div class="grid gap-6 md:grid-cols-[minmax(0,3fr)_minmax(0,2fr)] items-start">
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 space-y-3">
          <p
            data-key="contact-text"
            class="editable-field text-sm sm:text-base text-slate-300 leading-relaxed"
          >
            I am open to backend-focused roles, consulting, or collaborations on API-centric products.
            The fastest way to reach me is by email, but I also respond on LinkedIn.
          </p>
          <div class="space-y-2 text-xs sm:text-sm">
            <p class="text-slate-400">Email</p>
            <p
              data-key="contact-email"
              class="editable-field text-slate-200"
            >
              you@example.com
            </p>
            <p class="text-slate-400 mt-3">LinkedIn</p>
            <p
              data-key="contact-linkedin"
              class="editable-field text-slate-200 break-all"
            >
              https://www.linkedin.com/in/your-profile
            </p>
          </div>
        </div>

        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 space-y-4 text-xs sm:text-sm">
          <p class="text-slate-300">Quick message</p>
          <form id="contact-form" class="space-y-3">
            <div>
              <label for="contact-name" class="block text-[11px] mb-1 text-slate-400">Name</label>
              <input
                id="contact-name"
                type="text"
                class="w-full rounded-lg border border-slate-700 bg-slate-950/40 px-3 py-2 text-xs sm:text-sm outline-none focus:border-cyan-400 focus:ring-1 focus:ring-cyan-500/60"
              />
            </div>
            <div>
              <label for="contact-email-input" class="block text-[11px] mb-1 text-slate-400">Email</label>
              <input
                id="contact-email-input"
                type="email"
                class="w-full rounded-lg border border-slate-700 bg-slate-950/40 px-3 py-2 text-xs sm:text-sm outline-none focus:border-cyan-400 focus:ring-1 focus:ring-cyan-500/60"
              />
            </div>
            <div>
              <label for="contact-message" class="block text-[11px] mb-1 text-slate-400">Message</label>
              <textarea
                id="contact-message"
                rows="3"
                class="w-full rounded-lg border border-slate-700 bg-slate-950/40 px-3 py-2 text-xs sm:text-sm outline-none focus:border-cyan-400 focus:ring-1 focus:ring-cyan-500/60 resize-none"
              ></textarea>
            </div>
            <button
              type="submit"
              class="w-full mt-2 rounded-lg bg-teal-500 text-slate-950 py-2 text-xs sm:text-sm font-medium hover:bg-teal-400 transition-colors"
            >
              Send
            </button>
            <p id="contact-form-note" class="text-[11px] text-slate-500">
              In a real deployment this would call your Spring Boot API endpoint.
            </p>
          </form>
        </div>
      </div>
    </section>

    <!-- Integration Guide (Spring Boot & Java)
    <section id="integration" class="space-y-4">
      <div class="flex items-center justify-between gap-4">
        <h3 class="text-lg font-semibold tracking-tight">Integration</h3>
        <span class="text-[11px] uppercase tracking-[0.18em] text-slate-500">Spring Boot</span>
      </div>
      <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5 sm:p-6 space-y-3 text-xs sm:text-sm text-slate-300 leading-relaxed">
        <p>
          This portfolio is ready to connect to a Spring Boot backend. Typical REST endpoints:
        </p>
        <ul class="list-disc list-outside pl-5 space-y-1">
          <li><span class="text-teal-300">GET /api/portfolio</span> &ndash; load all editable fields as JSON.</li>
          <li><span class="text-teal-300">PUT /api/portfolio</span> &ndash; update all editable fields (admin only).</li>
          <li><span class="text-teal-300">POST /api/admin/login</span> &ndash; authenticate admin, returns JWT token.</li>
          <li><span class="text-teal-300">POST /api/contact</span> &ndash; send contact messages (name, email, message).</li>
        </ul>
        <p class="pt-2 text-slate-400">
          Place this file as <span class="font-mono">src/main/resources/static/index.html</span> in your Spring Boot
          project so it is served directly by the backend.
        </p>
      </div>
    </section> -->
  </main>

  <!-- Admin Toolbar -->
  <div id="admin-toolbar" class="hidden fixed bottom-4 left-1/2 -translate-x-1/2 z-40">
    <div class="flex flex-wrap items-center gap-3 rounded-full border border-slate-700 bg-slate-900/95 px-4 py-2 shadow-xl shadow-slate-950/80 text-[11px] sm:text-xs">
      <span class="text-slate-200">
        Editing mode: click any highlighted text to modify. Changes are saved to your Spring Boot backend.
      </span>
      <button
        id="toggle-highlight-btn"
        class="px-3 py-1 rounded-full border border-slate-600 hover:border-cyan-400 hover:text-cyan-200 transition-colors"
      >
        Toggle highlights
      </button>
      <button
        id="reset-data-btn"
        class="px-3 py-1 rounded-full border border-rose-600/70 text-rose-200 hover:border-rose-400 hover:bg-rose-600/10 transition-colors"
      >
        Reset content
      </button>
    </div>
  </div>

  <!-- Login Modal -->
  <div
    id="login-modal"
    class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-950/80"
    aria-hidden="true"
  >
    <div class="w-full max-w-sm rounded-2xl border border-slate-800 bg-slate-900/95 p-6 shadow-2xl shadow-slate-950/80">
      <div class="flex items-start justify-between gap-4 mb-4">
        <div>
          <h2 class="text-base sm:text-lg font-semibold tracking-tight">Admin login</h2>
          <p class="mt-1 text-[11px] text-slate-400">
            Demo credentials: <span class="font-mono">admin</span> / <span class="font-mono">admin123</span>.
            In production, connect this to your Spring Boot authentication.
          </p>
        </div>
        <button
          id="close-login-modal"
          class="text-slate-500 hover:text-slate-200 text-lg leading-none"
          aria-label="Close login dialog"
        >
          ×
        </button>
      </div>
      <form id="login-form" class="space-y-4">
        <div>
          <label for="login-username" class="block text-[11px] mb-1 text-slate-400">Username</label>
          <input
            id="login-username"
            type="text"
            autocomplete="username"
            class="w-full rounded-lg border border-slate-700 bg-slate-950/40 px-3 py-2 text-xs sm:text-sm outline-none focus:border-cyan-400 focus:ring-1 focus:ring-cyan-500/60"
          />
        </div>
        <div>
          <label for="login-password" class="block text-[11px] mb-1 text-slate-400">Password</label>
          <input
            id="login-password"
            type="password"
            autocomplete="current-password"
            class="w-full rounded-lg border border-slate-700 bg-slate-950/40 px-3 py-2 text-xs sm:text-sm outline-none focus:border-cyan-400 focus:ring-1 focus:ring-cyan-500/60"
          />
        </div>
        <p id="login-error" class="hidden text-[11px] text-rose-400"></p>
        <button
          type="submit"
          class="w-full rounded-lg bg-teal-500 text-slate-950 py-2 text-xs sm:text-sm font-medium hover:bg-teal-400 transition-colors"
        >
          Login as admin
        </button>
      </form>
    </div>
  </div>

  <!-- Toast (for future use) -->
  <div id="toast" class="pointer-events-none fixed bottom-5 right-5 z-50 hidden">
    <div class="rounded-full border border-emerald-500/70 bg-emerald-500/10 px-4 py-2 text-xs text-emerald-200 shadow-lg shadow-emerald-900/60 flex items-center gap-2">
      <span id="toast-message">Changes saved</span>
    </div>
  </div>

  <script>
    (function () {
      // Key for storing the JWT token from the backend
      const AUTH_TOKEN_KEY = "portfolioAuthToken";

      const state = {
        isAdmin: false,
        highlightsEnabled: true,
      };

      const body = document.body;
      const loginBtn = document.getElementById("login-btn");
      const logoutBtn = document.getElementById("logout-btn");
      const adminIndicator = document.getElementById("admin-indicator");
      const adminToolbar = document.getElementById("admin-toolbar");
      const toggleHighlightBtn = document.getElementById("toggle-highlight-btn");
      const resetDataBtn = document.getElementById("reset-data-btn");
      const editableFields = () => document.querySelectorAll(".editable-field[data-key]");

      const loginModal = document.getElementById("login-modal");
      const loginForm = document.getElementById("login-form");
      const loginUsername = document.getElementById("login-username");
      const loginPassword = document.getElementById("login-password");
      const loginError = document.getElementById("login-error");
      const closeLoginModalBtn = document.getElementById("close-login-modal");

      const contactForm = document.getElementById("contact-form");
      const toast = document.getElementById("toast");
      const toastMessage = document.getElementById("toast-message");

      function showToast(message) {
        if (!toast || !toastMessage) return;
        toastMessage.textContent = message;
        toast.classList.remove("hidden", "opacity-0");
        toast.classList.add("opacity-100");
        setTimeout(() => {
          toast.classList.add("opacity-0");
          setTimeout(() => toast.classList.add("hidden"), 300);
        }, 1500);
      }

      // Collect all editable fields from the page into a JSON object
      function collectData() {
        const data = {};
        editableFields().forEach((el) => {
          const key = el.dataset.key;
          data[key] = el.innerHTML;
        });
        return data;
      }

      // Helper to build Authorization header from stored token
      function authHeaders() {
        const token = localStorage.getItem(AUTH_TOKEN_KEY);
        if (!token) return {};
        return { Authorization: `Bearer ${token}` };
      }

      // Load all portfolio fields from Spring Boot backend (GET /api/portfolio)
      async function loadPortfolioFromBackend() {
        try {
          const res = await fetch("/api/portfolio");
          if (!res.ok) {
            console.warn("Failed to load portfolio from backend", res.status);
            return; // keep initial HTML content as fallback
          }

          const data = await res.json(); // expected shape: { fields: { key: value } }
          const fields = data && data.fields ? data.fields : {};

          editableFields().forEach((el) => {
            const key = el.dataset.key;
            if (Object.prototype.hasOwnProperty.call(fields, key)) {
              el.innerHTML = fields[key];
            }
          });
        } catch (e) {
          console.warn("Failed to load portfolio from backend", e);
        }
      }

      // Save all current editable fields back to backend (PUT /api/portfolio)
      async function savePortfolioToBackend() {
        const payload = { fields: collectData() };

        try {
          const res = await fetch("/api/portfolio", {
            method: "PUT",
            headers: {
              "Content-Type": "application/json",
              ...authHeaders(),
            },
            body: JSON.stringify(payload),
          });

          if (!res.ok) {
            console.warn("Failed to save portfolio to backend", res.status);
            return;
          }

          showToast("Changes saved");
        } catch (e) {
          console.warn("Failed to save portfolio to backend", e);
        }
      }

      function setAdminMode(enabled) {
        state.isAdmin = enabled;

        if (enabled) {
          body.classList.add("admin-mode");
          body.classList.remove("no-highlight");
          if (adminIndicator) adminIndicator.classList.remove("hidden");
          if (adminToolbar) adminToolbar.classList.remove("hidden");
          if (logoutBtn) logoutBtn.classList.remove("hidden");
          if (loginBtn) loginBtn.classList.add("hidden");

          editableFields().forEach((el) => {
            el.setAttribute("contenteditable", "true");
          });
        } else {
          body.classList.remove("admin-mode");
          if (adminIndicator) adminIndicator.classList.add("hidden");
          if (adminToolbar) adminToolbar.classList.add("hidden");
          if (logoutBtn) logoutBtn.classList.add("hidden");
          if (loginBtn) loginBtn.classList.remove("hidden");

          editableFields().forEach((el) => {
            el.removeAttribute("contenteditable");
          });
        }
      }

      function openLoginModal() {
        if (!loginModal) return;
        loginModal.classList.remove("hidden");
        loginModal.setAttribute("aria-hidden", "false");
        setTimeout(() => {
          loginUsername && loginUsername.focus();
        }, 50);
      }

      function closeLoginModal() {
        if (!loginModal) return;
        loginModal.classList.add("hidden");
        loginModal.setAttribute("aria-hidden", "true");
        if (loginError) {
          loginError.textContent = "";
          loginError.classList.add("hidden");
        }
        loginForm && loginForm.reset();
      }

      // Call Spring Boot login endpoint and store JWT token
      async function handleLogin(event) {
        event.preventDefault();
        if (!loginUsername || !loginPassword || !loginError) return;

        const username = loginUsername.value.trim();
        const password = loginPassword.value.trim();

        loginError.classList.add("hidden");
        loginError.textContent = "";

        try {
          const res = await fetch("/api/admin/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, password }),
          });

          if (!res.ok) {
            loginError.textContent = "Invalid credentials or login failed.";
            loginError.classList.remove("hidden");
            return;
          }

          const data = await res.json(); // expected: { token: "..." }
          if (!data || !data.token) {
            loginError.textContent = "Login response missing token.";
            loginError.classList.remove("hidden");
            return;
          }

          localStorage.setItem(AUTH_TOKEN_KEY, data.token);
          closeLoginModal();
          setAdminMode(true);
          showToast("Admin mode enabled");
        } catch (e) {
          console.warn("Login request failed", e);
          loginError.textContent = "Network or server error during login.";
          loginError.classList.remove("hidden");
        }
      }

      function handleLogout() {
        try {
          localStorage.removeItem(AUTH_TOKEN_KEY);
        } catch (e) {
          console.warn("Failed to clear auth token", e);
        }
        setAdminMode(false);
        showToast("Logged out of admin mode");
      }

      function toggleHighlights() {
        state.highlightsEnabled = !state.highlightsEnabled;
        if (state.highlightsEnabled) {
          body.classList.remove("no-highlight");
          toggleHighlightBtn && (toggleHighlightBtn.textContent = "Toggle highlights");
        } else {
          body.classList.add("no-highlight");
          toggleHighlightBtn && (toggleHighlightBtn.textContent = "Show highlights");
        }
      }

      // For now this just reloads the page and pulls fresh content from the backend
      function resetContent() {
        const confirmed = window.confirm(
          "Reload portfolio content from the server? Unsaved changes may be lost."
        );
        if (!confirmed) return;
        window.location.reload();
      }

      function handleEditableBlur() {
        // Whenever an editable field loses focus, save to the backend
        if (state.isAdmin) {
          savePortfolioToBackend();
        }
      }

      // Send contact form data to Spring Boot backend (POST /api/contact)
      async function handleContactSubmit(e) {
        e.preventDefault();
        const nameEl = document.getElementById("contact-name");
        const emailEl = document.getElementById("contact-email-input");
        const messageEl = document.getElementById("contact-message");

        const name = nameEl ? nameEl.value.trim() : "";
        const email = emailEl ? emailEl.value.trim() : "";
        const message = messageEl ? messageEl.value.trim() : "";

        try {
          const res = await fetch("/api/contact", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, email, message }),
          });

          if (res.ok) {
            showToast("Message sent");
            contactForm && contactForm.reset();
          } else {
            alert("Failed to send message. Please try again later.");
          }
        } catch (err) {
          console.warn("Failed to submit contact form", err);
          alert("Network error. Please check your connection.");
        }
      }

      function bindEvents() {
        if (loginBtn) loginBtn.addEventListener("click", openLoginModal);
        if (logoutBtn) logoutBtn.addEventListener("click", handleLogout);
        if (closeLoginModalBtn) closeLoginModalBtn.addEventListener("click", closeLoginModal);

        if (loginModal) {
          loginModal.addEventListener("click", (e) => {
            if (e.target === loginModal) closeLoginModal();
          });
        }

        if (loginForm) loginForm.addEventListener("submit", handleLogin);
        if (toggleHighlightBtn) toggleHighlightBtn.addEventListener("click", toggleHighlights);
        if (resetDataBtn) resetDataBtn.addEventListener("click", resetContent);

        if (contactForm) contactForm.addEventListener("submit", handleContactSubmit);

        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            if (loginModal && !loginModal.classList.contains("hidden")) {
              closeLoginModal();
            }
          }
        });

        editableFields().forEach((el) => {
          el.addEventListener("blur", handleEditableBlur);
        });
      }

      // Initialize: load content from backend and set up admin mode based on token
      loadPortfolioFromBackend();
      bindEvents();
      const existingToken = localStorage.getItem(AUTH_TOKEN_KEY);
      setAdminMode(!!existingToken);
    })();
  </script>
</body>
</html>